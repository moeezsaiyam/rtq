<br><h7>New question</h7>

<% form_for @question,:url => topic_sub_topic_questions_path(params[:topic_id],params[:sub_topic_id]), :method => :post do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.label :sub_topic_id %><br />
    <%= select("question", "sub_topic_id", SubTopic.find_all_by_topic_id(params[:topic_id]).collect {|t| [ t.name, t.id ] }) %>
  </p>
  <p>
    <%= f.label :quest %><br />
    <%= f.text_field :quest %>
  </p>
  <p>
    <%= f.label :answer %><br />
    <%= f.text_area :answer %>
  </p>
  <div id="alternate_phrases">
    <% @question.alternate_phrases.each do |alternate_phrase| %>
      <% fields_for "question[alternate_phrase_attributes][]", alternate_phrase do |phrase_form|%>
      <p>
      <%= phrase_form.label :content,"Alternate Phrase" %>
      </p>
        <%= phrase_form.text_field :content, :class => 'alternate_phrase_field' %>
        <%= phrase_form.hidden_field :question_id, :value=> @question_id %><br>
      <% end %>
    <% end %>
  </div>
   <p>
    <%= link_to ('Add Another','#',{:id =>'add_button'}) %>
  </p>
  <div id ="references_new">
  </div>
  <div id="references">
    <% @question.references.each do |reference| %>
      <% fields_for "question[reference_attributes][]", reference do |reference_form|%>
    <p>
      <%= reference_form.label :issue, "Issue Addressed"%>
    </p>
    <p>
        <%= reference_form.text_field :issue, :class => 'issue_field' %>
    </p>
     <p>
      <p><%= reference_form.label :from, "From"%>
      <%= reference_form.text_field :from, :class => 'issue_from_field' %>
      <%= reference_form.label :to, "To"%>
      <%= reference_form.text_field :to, :class => 'issue_to_field' %>
    </p>
      <%= reference_form.hidden_field :question_id, :value=> @question_id %>
      <% end %>
    <% end %>
  </div>
  <p>
    <%= link_to ('Add Another','#',{:id =>'add_reference_button'}) %>
  </p><br>
  <p>
    <%= f.submit 'Create' %>
  </p>
<% end %>

<%= link_to 'Back', topic_sub_topic_questions_path(params[:topic_id],params[:sub_topic_id]) %>
<div id="new_references" style="display:none;">
  <div>
    <% @question.references.each do |reference| %>
      <% fields_for "question[reference_attributes][]", reference do |reference_form|%>
    <p>
      <%= reference_form.label :issue, "Issue Addressed"%>
    </p>
    <p>
        <%= reference_form.text_field :issue, :class => 'issue_field' %>
    </p>
     <p>
      <p><%= reference_form.label :from, "From"%>
      <%= reference_form.text_field :from, :class => 'issue_from_field' %>
      <%= reference_form.label :to, "To"%>
      <%= reference_form.text_field :to, :class => 'issue_to_field' %>
    </p>
      <%= reference_form.hidden_field :question_id, :value=> @question_id %>
      <% end %>
    <% end %>
  </div>
</div>
